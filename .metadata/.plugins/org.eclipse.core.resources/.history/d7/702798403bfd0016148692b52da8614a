package com.ilbdaicnl.storm;

import org.apache.storm.utils.Utils;
import org.apache.storm.Config;
import org.apache.storm.LocalCluster;
import org.apache.storm.topology.TopologyBuilder;

public class TwitterStreamTopology {
	public static void main(String[] args) {
        String consumerKey = "83I2tVHGpTnZXE1RDcv9xe4Wa";
        String consumerSecret = "4xy4hp6Kq6CaNL3MGbxiybatoxblor33vSWkfnvse7grnN9DxL";
        String accessToken = "705821605885181952-yraRW7iQMyyVmiayv9U3KRvTEw11SI7";
        String accessTokenSecret = "g5wE6Gdm4NFZ1OkLQtiFKi7VrC96KGve3zmIZWEkuiSCd";
        String[] keyWords = new String[]{"storm"};

        TopologyBuilder builder = new TopologyBuilder();

        builder.setSpout("twitter", new TwitterStreamSpout(consumerKey, consumerSecret,
                accessToken, accessTokenSecret, keyWords), 1);
        builder.setBolt("print", new TwitterStreamPrint(),1)
                .shuffleGrouping("twitter");


        Config conf = new Config();


        LocalCluster cluster = new LocalCluster();

        cluster.submitTopology("test", conf, builder.createTopology());

        Utils.sleep(10000);
        cluster.shutdown();
    }
}
